spring:
  application:
    name: Merbs Connect

  datasource:
    url: ${DB_URL}
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:postgres}
    hikari:
      minimum-idle: 5
      maximum-pool-size: 20
      idle-timeout: 30000
      pool-name: MerbsConnectPool
      max-lifetime: 1800000
      connection-timeout: 30000

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    open-in-view: false
    properties:
      hibernate:
        format_sql: false
        jdbc:
          batch_size: 50
        order_inserts: true
        order_updates: true
    database-platform: org.hibernate.dialect.PostgreSQLDialect

  servlet:
    multipart:
      max-file-size: 50MB
      max-request-size: 50MB
      enabled: true

server:
  port: ${PORT:9000}
  address: 0.0.0.0
  shutdown: graceful
  tomcat:
    max-threads: 200
    accept-count: 100
    connection-timeout: 5000
  compression:
    enabled: true
    mime-types: text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json,application/xml
    min-response-size: 2048

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when-authorized

logging:
  level:
    root: INFO
    com.merbsconnect: INFO
    org.springframework.security: WARN
    org.hibernate.SQL: WARN
    org.hibernate.type.descriptor.sql: WARN

app:
  jwt:
    secret: ${JWT_SECRET}
    expiration: ${JWT_EXPIRATION:86400000}
    refresh-token-expiration: ${JWT_REFRESH_EXPIRATION:604800000}
    issuer: ${JWT_ISSUER:merbsconnect}

  admin:
    email: ${ADMIN_EMAIL}
    password: ${ADMIN_PASSWORD}
    phone: ${ADMIN_PHONE:+233000000000}

  token:
    expiry:
      verification-hours: ${TOKEN_VERIFICATION_HOURS:24}
      password-reset-hours: ${TOKEN_PASSWORD_RESET_HOURS:24}

    rate-limit:
      max-attempts: ${TOKEN_RATE_LIMIT_MAX_ATTEMPTS:5}
      cooldown-minutes: ${TOKEN_RATE_LIMIT_COOLDOWN_MINUTES:15}
      attempt-window-hours: ${TOKEN_RATE_LIMIT_ATTEMPT_WINDOW_HOURS:1}

    cleanup:
      cron: ${TOKEN_CLEANUP_CRON:0 0 0 * * *}

  email:
    from: ${EMAIL_FROM:noreply@merbsconnect.com}

  base-url: ${BASE_URL:https://api.merbsconnect.com}

  resend:
    api-key: ${RESEND_API_KEY}

  sms:
    mnotify:
      api-key: ${SMS_MNOTIFY_API_KEY}
      url: ${SMS_MNOTIFY_URL:https://api.mnotify.com/api/sms/quick}

# Swagger/OpenAPI - DISABLED in production by default
springdoc:
  api-docs:
    path: ${SWAGGER_API_DOCS_PATH:/api-docs}
    enabled: ${SWAGGER_API_DOCS_ENABLED:false}
  swagger-ui:
    path: ${SWAGGER_UI_PATH:/swagger-ui.html}
    enabled: ${SWAGGER_UI_ENABLED:false}

cloudflare:
  r2:
    endpoint: ${CLOUDFLARE_R2_ENDPOINT}
    bucket: ${CLOUDFLARE_R2_BUCKET}
    access-key-id: ${CLOUDFLARE_R2_ACCESS_KEY_ID}
    secret-access-key: ${CLOUDFLARE_R2_SECRET_ACCESS_KEY}
    region: ${CLOUDFLARE_R2_REGION:auto}